<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="/bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="/bower_components/iron-pages/iron-pages.html">
<link rel="import" href="/bower_components/iron-form/iron-form.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/paper-menu/paper-menu.html">
<link rel="import" href="/bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/iron-list/iron-list.html">

<dom-module id="tutor-queue-view">

	<template>

		<iron-ajax url="/help" auto handleas="json" last-response="{{helpList}}"></iron-ajax>

		<paper-header-panel class="flex">
			<paper-toolbar class="medium-tall">
				<div>USU Tutor Lab Queue</div>
				<span class="flex"></span>
				<paper-tabs class="bottom fit" selected="{{selectedPage}}">
					<paper-tab>Get Help</paper-tab>
					<paper-tab on-click="onSelectViewTab">View Queue</paper-tab>
				</paper-tabs>
			</paper-toolbar>
		</paper-header-panel>
		<iron-pages selected="{{selectedPage}}">
			<!-- Add -->
			<div>
				<form is="iron-form" id="help-form" method="post" action="/help">
					<paper-input name="studentName" label="Student Name" required=""></paper-input>
					<paper-input name="className" label="Course (e.g., CS 1400)" required=""></paper-input>
					<paper-input name="professor" label="Professor Name"></paper-input>
					<paper-input name="topic" label="Topic"></paper-input>
					<paper-button raised onclick="submitForm.call(this)">Submit</paper-button>
				</form>
			</div>
			<!-- View Queue -->
			<div>
				<h1>View Queue</h1>
				<iron-list items="[[helpList]]" as="item">
					<template>
						<paper-item>
							<paper-item-body>
								<span>{{item.student_name}}</span>
									<span>{{item.course}}</span>
									<span>{{item.professor}}</span>
									<span>{{item.topic}}</span>
									<span>{{item.created_date}}</span>
									<form is="iron-form" method="post" action="/help">
										<input type="hidden" name="id" value="234" />
										<paper-button raised name="help_button" onclick="helpSomeone.call(this)">Help</paper-button>
									</form>
							</paper-item-body>
						</paper-item>
					</template>
				</iron-list>
			</div>
		</iron-pages>
	</template>

	<script>
		Polymer({
			is: 'tutor-queue-view',
			properties: {
				selectedPage: {
					type: String,
					value: "0"
				},
				items: {
					type: Array,
					value: [{
						name: 'Kamaron'
					}, {
						name: 'Peterson'
					}, {
						name: 'Foobar'
					}]
				}
			},
			onSelectViewTab: function () {
				console.log('Hello from the view tab!');
			}
		});

		// Other functions...
		function submitForm() {
			// TODO KAM: Submit like this?
			document.getElementById('help-form').submit();
		}

		function helpSomeone(a) {
			// Get hidden input element
			var hiddenElement;

			for(var i = 0; i < this.parentElement.children.length; i++) {
				if (this.parentElement.children[0].name == 'id') {
					hiddenElement = this.parentElement.children[0];
				}
			}

			console.log('Somebody is being helped', a, this);

			
		}
	</script>

</dom-module>